<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="解密系列[基础篇] 多字节存储顺序两种编码区别:**Big-Endian:**高位字节存入低地址，低位字节存入高地址，依次排列。**Little-Endian :**低位字节存入低地址，高位字节存入高地址，反序排列         多字节数据存放顺序与CPU有关。 微处理器中存放顺序有正序（ Big-Endian）和逆序(Little-Endian） (也称大端存储和小端存储)之分。常见的Inte">
<meta property="og:type" content="article">
<meta property="og:title" content="解密系列basic">
<meta property="og:url" content="https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/index.html">
<meta property="og:site_name" content="幻境">
<meta property="og:description" content="解密系列[基础篇] 多字节存储顺序两种编码区别:**Big-Endian:**高位字节存入低地址，低位字节存入高地址，依次排列。**Little-Endian :**低位字节存入低地址，高位字节存入高地址，反序排列         多字节数据存放顺序与CPU有关。 微处理器中存放顺序有正序（ Big-Endian）和逆序(Little-Endian） (也称大端存储和小端存储)之分。常见的Inte">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/IZFRQK66[MK~]3S%7D62$Y4KJ.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/R~%60]HZH%7BDN_P3NYJL1V@MSF.png">
<meta property="og:image" content="d:\Users\lenovo\Desktop\5.png">
<meta property="og:image" content="d:\Users\lenovo\Desktop\4.png">
<meta property="og:image" content="d:\Users\lenovo\Desktop\3.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230131171812728.png">
<meta property="og:image" content="d:\Users\lenovo\Desktop\1.png">
<meta property="article:published_time" content="2023-08-31T16:00:00.000Z">
<meta property="article:modified_time" content="2023-09-01T12:19:02.881Z">
<meta property="article:author" content="yub">
<meta property="article:tag" content="知识碎片">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/yubsec/First@main/IZFRQK66[MK~]3S%7D62$Y4KJ.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>解密系列basic</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="幻境" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Articles</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/links/">Links</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2023/09/01/%E3%80%90%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97%E3%80%91pwn%E5%9F%BA%E7%A1%80/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2023/08/27/%E8%8D%92%E8%AF%9E/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&text=解密系列basic"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&is_video=false&description=解密系列basic"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=解密系列basic&body=Check out this article: https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&name=解密系列basic&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&t=解密系列basic"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E5%AD%97%E8%8A%82%E5%AD%98%E5%82%A8%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.</span> <span class="toc-text">多字节存储顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Win-API%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">Win API简介:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HWND-GetDlgItem%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">HWND GetDlgItem函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDUINT-GetDlgItemText%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">IDUINT GetDlgItemText函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetwindowText%E5%87%BD%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">GetwindowText函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UINT-GetDlgItemInt%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">UINT GetDlgItemInt函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MessageBox"><span class="toc-number">7.</span> <span class="toc-text">MessageBox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WM-COMMAND"><span class="toc-number">8.</span> <span class="toc-text">WM_COMMAND</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%A8%A1%E5%BC%8F"><span class="toc-number">9.</span> <span class="toc-text">实模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E2%88%B6%E6%97%A0%E8%AE%BA%E5%AE%9E%E6%A8%A1%E5%BC%8F%E8%BF%98%E6%98%AF%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A0%B9%E6%9C%AC%E7%9A%84%E9%97%AE%E9%A2%98%E9%83%BD%E4%B8%BA%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%BD%95%E5%9C%A8%E5%85%B6%E4%B8%AD%E8%BF%90%E8%A1%8C%E3%80%82"><span class="toc-number">10.</span> <span class="toc-text">保护模式∶无论实模式还是保护模式根本的问题都为程序如何在其中运行。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%EF%BC%88%E7%A1%AE%E5%AE%9E%E5%AD%98%E5%9C%A8%E4%BA%8E%E7%A1%AC%E7%9B%98%E4%B8%AD%EF%BC%89%E2%88%B6"><span class="toc-number">11.</span> <span class="toc-text">虚拟内存（确实存在于硬盘中）∶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95%E5%92%8C%E8%BF%87%E7%A8%8B%E2%88%B6"><span class="toc-number">11.1.</span> <span class="toc-text">简单的虚拟内存的实现方法和过程∶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93%EF%BC%9A"><span class="toc-number">12.</span> <span class="toc-text">小结：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PE%E6%96%87%E4%BB%B6"><span class="toc-number">13.</span> <span class="toc-text">PE文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E5%9C%B0%E5%9C%B0%E5%9D%80-Virtual-Address-VA"><span class="toc-number">14.</span> <span class="toc-text">虚地地址(Virtual Address, VA)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9C%B0%E5%9D%80%EF%BC%88-ImageBase"><span class="toc-number">15.</span> <span class="toc-text">基地址（ ImageBase)</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        解密系列basic
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">yub</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-31T16:00:00.000Z" class="dt-published" itemprop="datePublished">2023-09-01</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/">二进制安全</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/" rel="tag">知识碎片</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><em>解密系列[基础篇]</em></p>
<h3 id="多字节存储顺序"><a href="#多字节存储顺序" class="headerlink" title="多字节存储顺序"></a><strong>多字节存储顺序</strong></h3><p>两种编码区别:<br>**Big-Endian:**高位字节存入低地址，低位字节存入高地址，依次排列。<br>**Little-Endian :**低位字节存入低地址，高位字节存入高地址，反序排列         多字节数据存放顺序与CPU有关。</p>
<p>微处理器中存放顺序有正序（ Big-Endian）和逆序(Little-Endian） (也称大端存储和小端存储)之分。<br>常见的Intel系列使用的编码方式属于Little-Endian类；某些RISC架构的CPU·OIBM6Power-PC等属于Big-Endian类。</p>
<p>补充：ASCII （ American Standard Code for InformationInterchange·美国信息互换标准代码) 0-256。<br>Unicode字符编码的编码范围是︰0-65535·它包含三套编码方式如 :UTF-8·UTF-16和UTF-32·它和ASCII的关系为ASCII字符编码是Unicode字符编码的一部分。</p>
<h3 id="Win-API简介"><a href="#Win-API简介" class="headerlink" title="Win API简介:"></a><strong>Win API简介:</strong></h3><p>Windows API就是windows应用程序接口，是针对microsoft windows操作系统家族的系统编程接口，这样的系统包括Windows 7 ·Windows Vista - WindowsXP -Windows Server 2003 ·Windows 2000-Windows95 ·Windows 98-Windows Me (Millennium Editon）和OWindows CE等几乎所有版本。它被设计为各种语言的程序调用，也是应用软件与Windows系统最直培的交互方式。</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/IZFRQK66[MK~]3S%7D62$Y4KJ.png" alt="img"></p>
<p><strong>动态链接库</strong>︰动态链接就是把一些经常会共用的代码（静态链培的OBJ程序库）制作成DLL文件。当可执行文件调用到DLL文件内的函数时windows操作系统才会把DLL文件加载存储器内。<br>DLL文件本身的结构就是执i行文件（PE） ,当程序需求函数才进行链接，通过动态链接方式，存储器浪费的情形将大幅降低。                           <strong>kernel32.dll</strong>:控制着系统的内存管理﹑数据的输入输出操作和中断处理。当Windows启动时，kernel32.dll就驻留在内存中特定的写保护区域，使别的程序无法占用这个内存区域。<br><strong>user32.dll</strong>: Windows用户界面相关应用程序接口，用于包括Windows处理、基本用户界面等特性。如创建窗口和发送消息。<br><strong>gdi32.dll</strong>:是Windows GDI图形用户界面相关程序，包含的函数用来绘制图像和显示文字。   </p>
<p><strong>句柄</strong>：是整个windows编程的基础。<u>一个句柄是指使用的一个唯一的整数值</u><u>，用于标志应用程序中的不同对象和同类对象中的不同的实例</u>。<br>例：一个窗口，按钮，图标，滚动条，输出设备，控件或者文件等。应用程序能够通过句柄访问相应的对象的信息。<br>句柄是windows用来标志应用程序中建立的或是使用的唯一整数windows使用了大量的句柄来标志很多对象。</p>
<p>HWnd：带文本的窗口或控件的句柄。<br>IpString：指向接收文本的缓冲区的指针。<br>nMaxCount：指定要保存在缓冲区内的字符的最大个数，其中包含NULL字符      </p>
<h3 id="HWND-GetDlgItem函数"><a href="#HWND-GetDlgItem函数" class="headerlink" title="HWND GetDlgItem函数"></a><strong>HWND GetDlgItem函数</strong></h3><pre><code>hwndScroll = GetDlgItem(hwnd, IDC_SCROLL);       
</code></pre>
<p> 假设一个父窗口中有多个子窗口，那么本函数是返回一个子窗口句柄。第一个参数：父窗口句柄     第二个参数：子窗口    UINT </p>
<h3 id="IDUINT-GetDlgItemText函数"><a href="#IDUINT-GetDlgItemText函数" class="headerlink" title="IDUINT GetDlgItemText函数"></a><strong>IDUINT GetDlgItemText函数</strong></h3><p>​<br>（检索与对话框中的控件关联的标题或文本）                                                                                 </p>
<pre><code>GetDlgItemText(
  HWND hDlg,       // handle to dialog box
  int nIDDlgItem,  // control identifier
  LPTSTR lpString, // pointer to buffer for text
  int nMaxCount    // maximumsize of string
);                                      
</code></pre>
<h3 id="GetwindowText函数"><a href="#GetwindowText函数" class="headerlink" title="GetwindowText函数"></a><strong>GetwindowText函数</strong></h3><p>将指定窗口的标题条文本（如果存在）拷贝到一个缓存区内。             如果指定的窗口是一个控件，则拷贝控件的文本。                <u>GetWindowText不能接收在其他应用程序中的控件的文本。</u></p>
<pre><code>int GetWindowText(
  HWND hWnd,        // handle to window or control
  LPTSTR lpString,  // text buffer
  int nMaxCount     // maximum number of characters to copy
);
</code></pre>
<h3 id="UINT-GetDlgItemInt函数"><a href="#UINT-GetDlgItemInt函数" class="headerlink" title="UINT GetDlgItemInt函数"></a><strong>UINT GetDlgItemInt函数</strong></h3><p>（将对话框中指定控件的文本转换为整数值）                                                     </p>
<pre><code>UINT GetDlgItemInt(
  HWND hDlg,           // handle to dialog box
  int nIDDlgItem,      // control identifier
  BOOL *lpTranslated,  // success state
  BOOL bSigned         // signed or unsigned value
);
</code></pre>
<h3 id="MessageBox"><a href="#MessageBox" class="headerlink" title="MessageBox"></a>MessageBox</h3><p>（这个API方法用来创建、显示、操作一个消息框。它包含可设置的消息内容、标题，还可以添加预定义的图标、放置按钮）int </p>
<pre><code>int MessageBox(
  HWND hWnd,          // handle to owner window
  LPCTSTR lpText,     // text in message box
  LPCTSTR lpCaption,  // message box title
  UINT uType          // message box style
);
</code></pre>
<p>NT架构从内核到KERNEL32·USER32·GDI32都是纯32位实现。<br>NT架构标准字符集重头开发，统一使用Unicode字符集·兼容ASCII字符集。</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/R~%60]HZH%7BDN_P3NYJL1V@MSF.png" alt="img"></p>
<p>区别：1.函数调用完后谁来清空栈2.入栈顺序（两者均自右向左）stdcall由子程序平衡栈 cdel（c语言标准）由调用值平衡栈回调函数。（callback）回调函数</p>
<p><img src="D:\Users\lenovo\Desktop\5.png"></p>
<p><img src="D:\Users\lenovo\Desktop\4.png"></p>
<p>Windows操作系统最大的特点就是其图形化的操作只面和多任务的管理。这些强大功能就是建立在其消息处理机制这个基础之上的。Windows系统与应用程序之间，应用程序与应用程序之间的通讯就是通过消息来触发，并靠对消息的响应和处理来完成。<br>Windows系统中有两种消息队列:一种是<strong>系统消息队列</strong>，另一种是<strong>应用程序消息队列</strong>。Windows本身是由消息驱动，当调试程序时跟踪一个消息会得到相当底层的答案。                                                                        Windows为当前执行的每个Windows程序维护一个消息队列。<u>在发生某事件之后，系统将该事件转换为一个消息，并将消息投放入程序消息队列中。</u>程序通过i行一块称之为消息循环的程序代码从消息队列中取出消息!其实∶<strong>消息不过是定义一个结构。定义一堆ID，在程序运行过程中调用switch case拦截去完成巳应的功能。</strong></p>
<pre><code>while(GetMessage (&amp;msg, NULL,0,0))                               &#123;TranslateMessage (&amp;msg);//翻译消息
DispatchMessage (&amp;msg); &#125;//分配消总
</code></pre>
<p><strong>SendMessage函数</strong>                                                                                将指定的消息发送到一个或多个窗口。</p>
<pre><code>LRESULT [SendMessage]（HWND hWnd，UINT Msg，WPARAM wParam，LPARAM IParam）；
</code></pre>
<h3 id="WM-COMMAND"><a href="#WM-COMMAND" class="headerlink" title="WM_COMMAND"></a><strong>WM_COMMAND</strong></h3><p>产生的条件：点击<strong>菜单</strong>， 点击<strong>加速键</strong>（键盘快捷键，是一个或几个按键的组合，它用于激活特定的命令，使用加速键不需要费力移动鼠标就能激活菜单项），点击窗口<strong>按钮</strong>，点击<strong>工具栏按钮</strong>。这些时候都有command消息产生。<br> wParam 高两个字节 通知码<br>wParam 低两字节 命令ID<br>lParam 发送命令消息的子窗体句柄。<br> <strong>WM_GETTEXT</strong><br> <strong>WM_QUIT</strong><br><strong>WM_LBUTTONDOWN</strong><br><strong>WM_RBUTTONUP</strong><br><strong>WM_KEYUP</strong><br>（可自行查询相应用法及作用 我也是大懒虫捏【😀】）</p>
<h3 id="实模式"><a href="#实模式" class="headerlink" title="实模式"></a><strong>实模式</strong></h3><p>程序指令在执行过程中一般需要有各种数据,x86系列CS、DS、ES、FS、SS等用于指示不同用涂的数据段在内存中的位置。<br>x86系列使用中断机制来实现系统服务。<br>寄存器的扩展之路∶<br>8086以前（ 8bit） -&gt;8086（ 16bit） -&gt;80386(32bit)-&gt;现在的64bitCPU</p>
<p>寄存器（AL) -&gt;(AX)-&gt;（EAX）-&gt;(RAX)                                                         </p>
<h3 id="保护模式∶无论实模式还是保护模式根本的问题都为程序如何在其中运行。"><a href="#保护模式∶无论实模式还是保护模式根本的问题都为程序如何在其中运行。" class="headerlink" title="保护模式∶无论实模式还是保护模式根本的问题都为程序如何在其中运行。"></a><strong>保护模式</strong>∶无论实模式还是保护模式根本的问题都为程序如何在其中运行。</h3><p>和实模式下一样，保护模式下程序运行的实质仍是“CPU执行指令，操作相关数据”。主要改变的是寻址的方式，保护模式在寻址方式上“动了手脚””，为的是起到“保护作用”。</p>
<p><strong>保护模式</strong><br><u>一.不同任务之间的保护∶</u><br>通过把每个不同的任务放在不同的虚排地址空间中﹐来实现不同任务之间的隔离（即A程序不能访问和修改B程序的代码和数据）·以达到程序间的隔离;<br><u>二.同一任务的保护∶</u><br>在每一任务之内定义了4种保护级别·方别为0，1，2，3按环的方式表示.</p>
<p><img src="D:\Users\lenovo\Desktop\3.jpg"></p>
<p>其中，0级代表最高的权限级别，3级代表最低权限级别。按环的方式来表示。其中，环0、1、2为系统级，环3为用户级。<br>一般的系统只能使用环0和环3两个级别。                                             如上图所示，最外层的CodeAP1只能访问DataAP1。不能访问同级的另一应用程序的DataAP2;同样·CodeAP2只能访i6DataAP2 不能访DataAP1 。                                                                                            要说明的是：<strong>如果应用程序拥有第0级的权限，那么它就可以执行所有的指令并访问所有的数据。</strong><br>如果应用程序拥有的权限级别是第3级，它执行的指令是有限的，能访问的数据也是有限的（被保护)  。                                                                           操作系统的核心层是运行在Ring 0级。<br>WIN32子系统（KEDNET32.DLL 【内存的管理】USER32.DLL【操作用户的界面】 ，GDI32.DLL【操作图像的界面】等）是运行在Ring3级的，以提供与子程序的接口。</p>
<h3 id="虚拟内存（确实存在于硬盘中）∶"><a href="#虚拟内存（确实存在于硬盘中）∶" class="headerlink" title="虚拟内存（确实存在于硬盘中）∶"></a><strong>虚拟内存（</strong>确实存在于硬盘中）∶</h3><p>虚拟内存并不是真正的内存·它是通过射( Map）的方法﹐使用的虚拟地址（VA)达到4GB（因为EIP32位索引的最大范围是4GB）。<br>这样规定︰每个应用程序可以被分配到2GB的虚拟地址·剩下的2GB留给操作系统自己用。( Windows NT中·应用程序甚至有3GB为虚拟地址 )    </p>
<p>Windows是一个分时的多任务操作系统·CPU的时间被分割成一个个的时间片后行配给名个不同的应用程序·在一个时间片里，和这个应用程序护行无关的东西并不会又映射到线性地址中（这样EIP就索引不到）。</p>
<p>因比可以做到每个程序都拥有自己独立的4GB寻址空间·互不干扰。</p>
<p>要说明的是DLL与EXE不同【dll文件无自己的私有空间(动态链接文件）】</p>
<h4 id="简单的虚拟内存的实现方法和过程∶"><a href="#简单的虚拟内存的实现方法和过程∶" class="headerlink" title="简单的虚拟内存的实现方法和过程∶"></a><strong>简单的虚拟内存的实现方法和过程∶</strong></h4><p>1.当一个应用程序被启动时，操作系统创建一个新的进程，并给这个进程行配2GB的虚拟地址（不是内存哦 是地址)。<br>2.虚拟内存管理器将应用程序的代码射到哪个程序的虚拟地址中的某个位置，并把当前所需要的代码读取到内存物理地址中。<br>3.如果用动态链接库DLL，DLL程序也会被映射到进程的虚拟地址空i间在需要的时候才被读入物理内存。<br>4.其他项目(像数据﹑堆栈等)的空间是首先从物理内存中行配，再反向映射到虚拟地址空间中的。<br>5.应用程序通过使用的他的虚拟地址空间中的地址开始执行·然后由虚拟内存管理器把每次的内存访问映射到物理位置去。</p>
<h3 id="小结："><a href="#小结：" class="headerlink" title="小结："></a><strong>小结：</strong></h3><p>一.应用程序是不会直接访i问物理地址的。<br>二.虚拟内存管理器通过虚拟地址的访问请求，控制所有的物理地址访问；<br>三.每个程序都有独立的4G寻址空间·不同程虚拟地址空间是被互相隔离的;                                                                                                          四.DLL程序没有巨己的“私有”空间·它们称之为动态链接库文件·它们总是被射到其他应用程序的地址空间中的﹐作为其他应用程序的一部行运行。<br>最后，使用虚拟内存的好处是︰简化了内存的管理，并弥补物理内存的不足。另外以防止多任务环境下各个应用程序之间的冲突!</p>
<h3 id="PE文件"><a href="#PE文件" class="headerlink" title="PE文件"></a><strong>PE文件</strong></h3><p>PE的意思就是Portable Executable （可移植的挖行体)。它是Windows环境身所带的e行体文件格式。<br>它的一些特性继承由Unix Coff (commonobject file format)文件格式。<br>“portable executable”（己移植的执行体）意味着此文件格式是跨win32平台的:也就是说即使Windows 运行在非IntelCPU 上·任意win32平台的PE装载器都能识别和使用该文件格式。</p>
<p>基本上所有win32执行体(除了VxD和16位的DI)都用PE文件格式，包括NT的内核模式驱动程序( kernel mode drivers ) 。因而研究PE文件格式给了我们洞悉 Windows结构的良机。<br>PE文件用的是一个平面地址空间·所有代码和数据都合并在一起·组成一个很大结构文件的内容被行割为不同的区块（Section又称为区段·节等)·块中包含代码或数据。</p>
<p>每个区块都有巨己在内存中的属性：可读&#x2F;写·只读等。<br>每个区块都有不同的名字，这用名字主要用来表示区块功能。</p>
<p><img src="https://cdn.jsdelivr.net/gh/yubsec/First@main/image-20230131171812728.png" alt="image-20230131171812728"></p>
<p>PE文件非常好的一个地方就是在磁盘上的数据结构与在内存中的结构是一致的。<br>当至统装载一个己i行文件到内存中·主要就是将一个PE文件的某一部方映射到地址空间中·这样﹐PE文件的数据结沟在磁盘和内存中就是一样的了。</p>
<p><img src="D:\Users\lenovo\Desktop\1.png"></p>
<p>(1）入口点（Entry Point）<br>PE文件巳行时的入口点（Entry Point) 。也就是说·程序在执行时的第一行代码地址应该就是这个值·有点像8086汇编语言中end start中start指向的入口地址。<br>(2）文件偏移地址（File Offset）<br>当PE文件储存在磁盘上的时候·各数据的地址称作文件的移地址·文件偏移地址人PE文件的第一个字节开始计数·起始值为0。</p>
<h3 id="虚地地址-Virtual-Address-VA"><a href="#虚地地址-Virtual-Address-VA" class="headerlink" title="虚地地址(Virtual Address, VA)"></a><strong>虚地地址(Virtual Address, VA)</strong></h3><p>由于Windows程序运行在保护模式下·所以应用程序访问存储器所使用的逻辑地址称为虚拟地址（因为他不是真正的物理地址·真正的物理地址被windows妈妈的保护机制保护起来)﹐又称为内存偏移地址（Memory Offset) 。实地址模式下的“段址也写地址∶偏移地址索引方式类似·虚樽地;成“段∶偏移量”的形式·但不同之处在于这里的段不再是段地切而是指段选择子。<br>例t :”0123:004010003’<br>0123∶表示段选择子。其数据存储在CS段选择器里。同一程序在不同系统环境下此值可能不同，因比我们不需要关心。<br>00401000∶此处表示内存中的虚拟地址。一般来说，同一个程序的向一条指令在不同系统环境下，此值相同（PE映射原理）。</p>
<h3 id="基地址（-ImageBase"><a href="#基地址（-ImageBase" class="headerlink" title="基地址（ ImageBase)"></a><strong>基地址（ ImageBase)</strong></h3><p>文件执行时将被映射到指定内存地址中·这个初始内存地址称为基地址。这个值是由PE文件本身设定的。<br>控照默认设置·用Visual C++建立的EXE文件基地址是00400000h。DLL支件基地址是10000000h。但这个值可自己在编译器设定的。</p>

  </div>
</article>





        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Articles</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/links/">Links</a></li>
        
          <li><a href="/tags/">Tags</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E5%AD%97%E8%8A%82%E5%AD%98%E5%82%A8%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.</span> <span class="toc-text">多字节存储顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Win-API%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">Win API简介:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HWND-GetDlgItem%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">HWND GetDlgItem函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDUINT-GetDlgItemText%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">IDUINT GetDlgItemText函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetwindowText%E5%87%BD%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">GetwindowText函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UINT-GetDlgItemInt%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">UINT GetDlgItemInt函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MessageBox"><span class="toc-number">7.</span> <span class="toc-text">MessageBox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WM-COMMAND"><span class="toc-number">8.</span> <span class="toc-text">WM_COMMAND</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%A8%A1%E5%BC%8F"><span class="toc-number">9.</span> <span class="toc-text">实模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E2%88%B6%E6%97%A0%E8%AE%BA%E5%AE%9E%E6%A8%A1%E5%BC%8F%E8%BF%98%E6%98%AF%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A0%B9%E6%9C%AC%E7%9A%84%E9%97%AE%E9%A2%98%E9%83%BD%E4%B8%BA%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%BD%95%E5%9C%A8%E5%85%B6%E4%B8%AD%E8%BF%90%E8%A1%8C%E3%80%82"><span class="toc-number">10.</span> <span class="toc-text">保护模式∶无论实模式还是保护模式根本的问题都为程序如何在其中运行。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%EF%BC%88%E7%A1%AE%E5%AE%9E%E5%AD%98%E5%9C%A8%E4%BA%8E%E7%A1%AC%E7%9B%98%E4%B8%AD%EF%BC%89%E2%88%B6"><span class="toc-number">11.</span> <span class="toc-text">虚拟内存（确实存在于硬盘中）∶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95%E5%92%8C%E8%BF%87%E7%A8%8B%E2%88%B6"><span class="toc-number">11.1.</span> <span class="toc-text">简单的虚拟内存的实现方法和过程∶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93%EF%BC%9A"><span class="toc-number">12.</span> <span class="toc-text">小结：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PE%E6%96%87%E4%BB%B6"><span class="toc-number">13.</span> <span class="toc-text">PE文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E5%9C%B0%E5%9C%B0%E5%9D%80-Virtual-Address-VA"><span class="toc-number">14.</span> <span class="toc-text">虚地地址(Virtual Address, VA)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9C%B0%E5%9D%80%EF%BC%88-ImageBase"><span class="toc-number">15.</span> <span class="toc-text">基地址（ ImageBase)</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&text=解密系列basic"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&is_video=false&description=解密系列basic"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=解密系列basic&body=Check out this article: https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&title=解密系列basic"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&name=解密系列basic&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://yubut.github.io/2023/09/01/%E8%A7%A3%E5%AF%86%E7%B3%BB%E5%88%97[%E5%9F%BA%E7%A1%80%E7%AF%87]/&t=解密系列basic"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
    <div class="footer-left">
        Copyright ©
        
        
        2023-2024
        yub
        <br>
        <!-- 删除备案信息，如果不需要备案可以省略以下行 -->
        <!-- <a href="https://beian.miit.gov.cn/" target="_blank">xICP备xxxxxxxx号-x</a> -->
    </div>

    <div class="footer-right">
        <nav>
            <ul>
                
                <li><a href="/">Home</a></li>
                
                <li><a href="/about/">About</a></li>
                
                <li><a href="/archives/">Articles</a></li>
                
                <li><a href="/categories/">Categories</a></li>
                
                <li><a href="/links/">Links</a></li>
                
                <li><a href="/tags/">Tags</a></li>
                
                <li><a href="/search/">Search</a></li>
                
            </ul>
            
            <ul>
                <span id="busuanzi_container_site_pv">
                    本站总访问量<span id="busuanzi_value_site_pv"></span>次
                </span>
                <span class="post-meta-divider">|</span>
                <span id="busuanzi_container_site_uv" style='display:none'>
                    本站访客数<span id="busuanzi_value_site_uv"></span>人
                </span>
                <!-- 引入不蒜子脚本 -->
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            </ul>
            
        </nav>
    </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
